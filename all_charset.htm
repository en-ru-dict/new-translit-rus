<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Translit wrapper — multiple charsets</title>
<style>
  body{font-family:Arial,Helvetica,sans-serif;margin:12px}
  .controls{display:flex;gap:8px;align-items:center;margin-bottom:10px}
  .iframes{display:flex;flex-wrap:wrap;gap:12px;width:98%}
  .frame-box{border:1px solid #ddd;padding:8px;width:100%;background:#fff}
  .frame-box h4{margin:0 0 8px 0;font-size:14px}
  .small{font-size:13px;color:#444}
  button{padding:6px 8px}
</style>
<script src='htm.js'></script>
</head>
<body>
Пример во всех кодировках!
<div class="iframes" id="framesContainer"></div>
<script>
var charsets = [
  {name:'UTF-8', label:'utf-8'},
  {name:'Windows-1251', label:'windows-1251'},
  {name:'KOI8-R', label:'koi8-r'},
  {name:'ISO-8859-5', label:'iso-8859-5'},
  {name:'CP866', label:'cp866'}
];

var container = document.getElementById('framesContainer');
function clearContainer(){ container.innerHTML = ''; }
function makeFrameBox(charset, htmlContent){
  var box = document.createElement('div');
  box.className = 'frame-box';
  var title = document.createElement('h4');
  title.textContent = charset.name + ' — ' + charset.label;
  box.appendChild(title);
  var frame = document.createElement('iframe');
  frame.width = '98%';  frame.height = '700px';
  frame.style.border = '1px solid #ccc';
  box.appendChild(frame);

  // Create blob with explicit charset
  var blob = new Blob([htmlContent], {type: 'text/html;charset=' + charset.label});
  var url = URL.createObjectURL(blob);
  frame.src = url;


  return box;
}

async function renderAll(){
  clearContainer();
    var htmlContent = g_htm;
    // If the fetched HTML contains a <meta charset=...> we leave it (the Blob type header will control)
    charsets.forEach(function(c){
      container.appendChild(makeFrameBox(c, htmlContent));
    });

}

renderAll();
</script>
</body>
</html>
